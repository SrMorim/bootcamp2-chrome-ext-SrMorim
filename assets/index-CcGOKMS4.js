(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();class m{constructor(){this.state=this.loadState(),this.settings=this.loadSettings(),this.tickInterval=null,this.tickCallback=null,this.completeCallback=null}static getDefaultSettings(){return{focusDuration:25,shortBreakDuration:5,longBreakDuration:15,longBreakInterval:4,soundEnabled:!0,notificationsEnabled:!0}}loadState(){const t=localStorage.getItem("pomodoroState");return t?JSON.parse(t):{mode:"focus",timeRemaining:25*60,isRunning:!1,sessionsCompleted:0}}saveState(){localStorage.setItem("pomodoroState",JSON.stringify(this.state))}loadSettings(){const t=localStorage.getItem("pomodoroSettings");return t?JSON.parse(t):m.getDefaultSettings()}saveSettings(){localStorage.setItem("pomodoroSettings",JSON.stringify(this.settings))}getState(){return{...this.state}}getSettings(){return{...this.settings}}updateSettings(t){this.settings={...this.settings,...t},this.saveSettings(),this.state.isRunning||(this.state.timeRemaining=this.getDurationForMode(this.state.mode)*60,this.saveState())}restoreDefaults(){this.settings=m.getDefaultSettings(),this.saveSettings(),this.state.isRunning||(this.state.timeRemaining=this.getDurationForMode(this.state.mode)*60,this.saveState())}getDurationForMode(t){switch(t){case"focus":return this.settings.focusDuration;case"shortBreak":return this.settings.shortBreakDuration;case"longBreak":return this.settings.longBreakDuration;default:return this.settings.focusDuration}}start(){this.state.isRunning||(this.state.isRunning=!0,this.saveState(),this.tickInterval=setInterval(()=>{this.tick()},1e3))}pause(){this.state.isRunning&&(this.state.isRunning=!1,this.saveState(),this.tickInterval&&(clearInterval(this.tickInterval),this.tickInterval=null))}reset(){this.pause(),this.state.timeRemaining=this.getDurationForMode(this.state.mode)*60,this.saveState()}skip(){this.pause(),this.switchToNextMode(),this.saveState()}changeMode(t){this.pause(),this.state.mode=t,this.state.timeRemaining=this.getDurationForMode(t)*60,this.saveState()}tick(){if(this.state.timeRemaining--,this.state.timeRemaining<=0){const t=this.state.mode;t==="focus"&&this.state.sessionsCompleted++,this.switchToNextMode(),this.pause(),this.saveState(),this.completeCallback&&this.completeCallback(t)}else this.saveState(),this.tickCallback&&this.tickCallback()}switchToNextMode(){this.state.mode==="focus"?this.state.sessionsCompleted%this.settings.longBreakInterval===0?this.state.mode="longBreak":this.state.mode="shortBreak":this.state.mode="focus",this.state.timeRemaining=this.getDurationForMode(this.state.mode)*60}onTick(t){this.tickCallback=t}onComplete(t){this.completeCallback=t}}class Z{constructor(){this.baseURL="https://bootcamp-pomodoro-api.onrender.com"}async getQuote(){try{const t=await fetch(`${this.baseURL}/api/quote`);if(!t.ok)throw new Error("Failed to fetch quote");return await t.json()}catch(t){return console.error("Error fetching quote:",t),{content:"A persistência é o caminho do êxito.",author:"Charles Chaplin"}}}async getSessions(){try{const t=await fetch(`${this.baseURL}/api/sessions`);if(!t.ok)throw new Error("Failed to fetch sessions");return await t.json()}catch(t){return console.error("Error fetching sessions:",t),this.getLocalSessions()}}async saveSession(t){try{const s=await fetch(`${this.baseURL}/api/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to save session");return await s.json()}catch(s){return console.error("Error saving session:",s),this.saveLocalSession(t),t}}async clearSessions(){try{const t=await fetch(`${this.baseURL}/api/sessions`,{method:"DELETE"});if(!t.ok)throw new Error("Failed to clear sessions");return localStorage.removeItem("pomodoroSessions"),await t.json()}catch(t){console.error("Error clearing sessions:",t),localStorage.removeItem("pomodoroSessions")}}async getStats(){try{const t=await fetch(`${this.baseURL}/api/sessions/stats`);if(!t.ok)throw new Error("Failed to fetch stats");return await t.json()}catch(t){console.error("Error fetching stats:",t);const s=this.getLocalSessions();return this.calculateStats(s)}}getLocalSessions(){const t=localStorage.getItem("pomodoroSessions");return t?JSON.parse(t):[]}saveLocalSession(t){const s=this.getLocalSessions();s.unshift({...t,id:Date.now().toString()}),s.length>100&&s.splice(100),localStorage.setItem("pomodoroSessions",JSON.stringify(s))}calculateStats(t){const s=t.length,r=t.reduce((i,l)=>i+l.duration,0),n=t.filter(i=>{const l=new Date(i.completedAt),d=new Date;return l.toDateString()===d.toDateString()}).length,o=t.filter(i=>{const l=new Date(i.completedAt),d=new Date,W=new Date(d.getTime()-7*24*60*60*1e3);return l>=W}).length;return{total:s,totalMinutes:r,today:n,thisWeek:o}}}const a=new m,g=new Z,M=document.getElementById("timerDisplay"),q=document.getElementById("modeDisplay"),K=document.getElementById("sessionCount"),I=document.getElementById("startBtn"),D=document.getElementById("pauseBtn"),O=document.getElementById("resetBtn"),P=document.getElementById("skipBtn"),L=document.querySelectorAll(".tab-btn"),T=document.querySelector(".timer-section"),h=document.getElementById("quoteSection"),f=document.getElementById("quoteText"),p=document.getElementById("quoteAuthor"),u=document.getElementById("onlineStatus"),F=document.querySelectorAll(".nav-btn"),B=document.getElementById("historyTab"),y=document.getElementById("settingsTab"),v=document.querySelector("main"),S=document.getElementById("sessionsList"),X=document.getElementById("totalSessions"),A=document.getElementById("totalTime"),w=document.getElementById("todaySessions"),$=document.getElementById("clearHistoryBtn"),b=document.getElementById("focusDuration"),Q=document.getElementById("shortBreakDuration"),C=document.getElementById("longBreakDuration"),x=document.getElementById("longBreakInterval"),H=document.getElementById("soundEnabled"),R=document.getElementById("notificationsEnabled"),j=document.getElementById("restoreDefaultsBtn"),k={focus:"Foco",shortBreak:"Pausa Curta",longBreak:"Pausa Longa"};function c(){const e=a.getState(),t=Math.floor(e.timeRemaining/60),s=e.timeRemaining%60;M.textContent=`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}`,q.textContent=k[e.mode],K.textContent=e.sessionsCompleted,e.isRunning?(I.disabled=!0,D.disabled=!1,T.classList.add("running")):(I.disabled=!1,D.disabled=!0,T.classList.remove("running")),L.forEach(r=>{r.dataset.mode===e.mode?r.classList.add("active"):r.classList.remove("active")}),e.mode==="shortBreak"||e.mode==="longBreak"?(h.style.display==="none"&&J(),h.style.display="block"):h.style.display="none"}async function J(){try{f.innerHTML='<span class="loading"></span> Carregando frase...',p.textContent="";const e=await g.getQuote();f.textContent=`"${e.content}"`,p.textContent=`— ${e.author}`}catch(e){console.error("Failed to load quote:",e),f.textContent="Aproveite sua pausa! ☕",p.textContent=""}}I.addEventListener("click",()=>{a.start(),c()});D.addEventListener("click",()=>{a.pause(),c()});O.addEventListener("click",()=>{confirm("Resetar o timer atual?")&&(a.reset(),c())});P.addEventListener("click",()=>{confirm("Pular para a próxima sessão?")&&(a.skip(),c())});L.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.mode;a.changeMode(t),c()})});a.onTick(()=>{c()});a.onComplete(async e=>{c();try{await g.saveSession({mode:e,duration:a.getDurationForMode(e),completedAt:new Date().toISOString()})}catch(s){console.error("Failed to save session:",s)}if(Notification.permission==="granted"){const s=k[e];new Notification("Pomodoro Completo!",{body:`Sessão de ${s} finalizada. Parabéns!`,icon:"/icons/icon-192.png",badge:"/icons/icon-192.png"})}a.getSettings().soundEnabled&&U()});function U(){new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSd+zPLTgjMGHm/A7+OZSA0PXLLT7K1aFQlGpOLyvWseBSJ4yfXYkTsIGnXG6t+XTAoRYLXr7K5aEwhBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XTQsQX7Xr7K1ZFAlBmuHyvm0fBiF2x/TalD0IGW7B7d+XT").play().catch(t=>console.log("Could not play sound:",t))}F.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.tab;F.forEach(s=>s.classList.remove("active")),e.classList.add("active"),t==="timer"?(v.style.display="block",B.style.display="none",y.style.display="none"):t==="history"?(v.style.display="none",B.style.display="block",y.style.display="none",G()):t==="settings"&&(v.style.display="none",B.style.display="none",y.style.display="block",N())})});async function G(){try{const e=await g.getSessions();if(e.length===0){S.innerHTML='<p class="empty-state">Nenhuma sessão registrada ainda.</p>',X.textContent="0",A.textContent="0h",w.textContent="0";return}const t=e.length,s=e.reduce((o,i)=>o+i.duration,0),r=Math.floor(s/60),n=e.filter(o=>{const i=new Date(o.completedAt),l=new Date;return i.toDateString()===l.toDateString()}).length;X.textContent=t,A.textContent=r>0?`${r}h`:`${s}min`,w.textContent=n,S.innerHTML=e.slice(0,20).map(o=>{const i=new Date(o.completedAt),l=i.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),d=i.toLocaleDateString("pt-BR");return`
        <div class="session-item">
          <div class="session-info">
            <div class="session-mode">${k[o.mode]}</div>
            <div class="session-time">${d} às ${l}</div>
          </div>
          <div class="session-duration">${o.duration}min</div>
        </div>
      `}).join("")}catch(e){console.error("Failed to load history:",e),S.innerHTML='<p class="empty-state">Erro ao carregar histórico.</p>'}}$.addEventListener("click",async()=>{if(confirm("Tem certeza que deseja limpar todo o histórico?"))try{await g.clearSessions(),G()}catch(e){console.error("Failed to clear history:",e),alert("Erro ao limpar histórico.")}});function N(){const e=a.getSettings();b.value=e.focusDuration,Q.value=e.shortBreakDuration,C.value=e.longBreakDuration,x.value=e.longBreakInterval,H.checked=e.soundEnabled,R.checked=e.notificationsEnabled}document.querySelector(".settings-form").addEventListener("submit",e=>{e.preventDefault();const t={focusDuration:parseInt(b.value),shortBreakDuration:parseInt(Q.value),longBreakDuration:parseInt(C.value),longBreakInterval:parseInt(x.value),soundEnabled:H.checked,notificationsEnabled:R.checked};a.updateSettings(t),alert("Configurações salvas!")});j.addEventListener("click",()=>{confirm("Restaurar configurações padrão?")&&(a.restoreDefaults(),N())});Notification.permission==="default"&&Notification.requestPermission();function E(){navigator.onLine?(u.textContent="● Online",u.className="status-badge online"):(u.textContent="● Offline",u.className="status-badge offline")}window.addEventListener("online",E);window.addEventListener("offline",E);E();c();"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(()=>{console.log("Service Worker registered")}).catch(e=>{console.error("Service Worker registration failed:",e)});console.log("🍅 Bootcamp Pomodoro PWA v2.0.0 loaded");
//# sourceMappingURL=index-CcGOKMS4.js.map
